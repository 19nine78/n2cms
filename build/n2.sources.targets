<?xml version="1.0" encoding="utf-8" ?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="3.5">

	<!-- SOURCE -->


	<Target Name="Source-Deploy">
		<ItemGroup>
			<Source-Files Include="$(MSBuildProjectDirectory)\..\**\*"
						  Exclude="$(MSBuildProjectDirectory)\..\**\.svn\**\*;
								   $(MSBuildProjectDirectory)\..\output\**\*;
								   $(MSBuildProjectDirectory)\..\**\_*\**\*;
								   $(MSBuildProjectDirectory)\..\**\*WebSetup\**\*;
								   $(MSBuildProjectDirectory)\..\**\*VsTemplate\**\*;
								   $(MSBuildProjectDirectory)\..\**\obj\**\*;
								   $(MSBuildProjectDirectory)\..\**\bin\**\*;
								   $(MSBuildProjectDirectory)\..\**\PrecompiledWeb\**\*;
								   $(MSBuildProjectDirectory)\..\**\Ankh.Load;
								   $(MSBuildProjectDirectory)\..\**\*.sln.cache;
								   $(MSBuildProjectDirectory)\..\**\*.resharper;
								   $(MSBuildProjectDirectory)\..\**\*.suo;
								   $(MSBuildProjectDirectory)\..\**\*.user;
								   $(MSBuildProjectDirectory)\..\*.xml;
								   $(MSBuildProjectDirectory)\..\**\*.Publish.xml;
								   $(MSBuildProjectDirectory)\..\**\Thumbs.db;
								   $(DeployFolder)\**\*;
								   $(Examples-Folder)\**\N2\**\*;
								   $(LibFolder)\*.pdb" />
		</ItemGroup>

		<Copy SourceFiles="@(Source-Files)" DestinationFolder="$(DeployFolder)\Source\%(RecursiveDir)"  />
	</Target>

	<Target Name="Source-Zip" DependsOnTargets="Source-Deploy">
		<ItemGroup>
			<ZipDeploy-Source Include="$(DeployFolder)\Source\**" />
		</ItemGroup>

		<Error Condition="'@(ZipDeploy-Source)' == ''" Text="Nothing in '$(DeployFolder)\Source'. Do deploy first." />

		<Zip Files="@(ZipDeploy-Source)"          WorkingDirectory="$(DeployFolder)\Source"                 ZipFileName="$(DeployFolder)\Sources.zip" />
	</Target>
	
</Project>