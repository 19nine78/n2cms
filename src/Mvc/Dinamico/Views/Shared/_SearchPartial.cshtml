
@{using (Html.BeginForm("Search", null, new { item = Content.StartPage }, FormMethod.Get, new { id = "searchform" }))
  {
	<input name="q" />
	<button type="submit"></button>
  }
}

<script type="text/javascript">//<![CDATA[
	$(document).ready(function () {
		$("#searchform").submit(function (e) {
			e.preventDefault();
			var data = $(this).serialize();
			var hash = "#" + data;
			$("<ul id='searchresults'><li class='loading'>Loading...</li></ul>").appendTo(this)
				.load(this.action, data, function () {
					var here = location.href.replace(/#.*/, "");
					$("a", this).each(function (i) {
						if (i === 0) this.focus();
						if (this.href === here) this.focus();
						console.log(this, this.href, hash, here, data);
						this.href += hash;
					});
				});
		});
		$(document).click(function (e) {
			if ($(e.target).closest("#searchform").length == 0)
				$("#searchresults").remove();
		});
		if (location.hash.match("^#q="))
		{
			$("#searchform input").attr("value", location.hash.substr(3));
			$("#searchform").submit();
		}
	});
//]]></script>